task purge(type:Delete){
    delete 'build'
}

task dependance(type:Exec, dependsOn:purge){
    executable 'sh'
    args '-c', 'pip3 install -r requirements.txt'
      standardOutput = new ByteArrayOutputStream()

      //extension method execSomething.output() can be used to obtain the output:
      ext.output = {
        return standardOutput.toString()
      }
}
  
task lint (type:Exec, dependsOn:dependance){
    executable 'sh'
    args '-c', 'mkdir -p test-reports/flake8 && flake8 --format=html --htmldir=test-reports/flake8 ./*.py'
    ignoreExitValue true
}

task pycodestyle(type:Exec, dependsOn:lint) {
    executable 'sh'
    args '-c', "pycodestyle ./*.py >> result-pycode.report"
    ignoreExitValue true
}
   
task packageDistribution(type:Zip, dependsOn:pycodestyle){
    from('/project') into ('.')
    archiveFileName = 'demo-python.zip'
    destinationDirectory = file('build')
}