pipeline {
 agent any
  stages {
    stage('clone'){
      steps {
        git url: 'https://github.com/JeanHuret/FormationPOEI.git'
      }
    }
    stage('Build'){
      tools {
        gradle 'gradle'
      }
      steps {
        sh 'cd TP5_Intégration_continue/tp-sql/app-python && gradle purge'
        sh 'cd TP5_Intégration_continue/tp-sql/app-python && gradle dependance'
        sh 'cd TP5_Intégration_continue/tp-sql/app-python && gradle lint'
        sh 'cd TP5_Intégration_continue/tp-sql/app-python && gradle packageDistribution'
      }
    } 
    stage('Rapport qualité'){
      tools {
        gradle 'gradle'
      }
      steps {
        sh 'cd TP5_Intégration_continue/tp-sql/app-python && gradle lint'
      }
    }
<<<<<<< HEAD
=======
    stage ('Ansible'){
      tools {
        ansible 'ansible'
      }
      steps {
        sh 'cd TP6_ansible_deploiement && docker-compose up -d'
        sh 'cd TP6_ansible_deploiement && docker exec -it master01 sh && ansible-playook playbook.yml'
      }
    }   
  }
>>>>>>> e419b5b6e6c735b2c8edff0bbfa27b98ee3589b9
  post {
       always{
            junit (
              allowEmptyResults: true,
              testResults: 'test-reports/flake8/*.xml'
            )
        }
    }
 }
